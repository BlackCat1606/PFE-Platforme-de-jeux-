{% extends "admin/_page-admin.html" %}
{% import "event/_macros-edit-event.html" as editEventMacros %}

{% block adminBody %}

<h1>Préréglages d'événements</h1>

{% if not editEventPreset %}
  <p>Les préréglages d'événements ne sont qu'un moyen de simplifier l'administration des événements: ils permettent de modifier de nombreux paramètres d'événement (états, appel à l'action) en une seule étape.</p>

  <p>
    <a href="?create" class="btn btn-primary">Créer</a> 
  </p>
{% else %}
  <div class="well">
    <h2><span id="preset-header"></span></h2>
    <form method="post" action="?">
      {{ csrfToken() | safe }}
      <div class="form-group">
        <label for="title">Titre du Préréglage</label>
        <input type="text" class="form-control js-sync-text" name="title" value="{{ editEventPreset.get('title') }}"
          data-sync-text-display-selector="#preset-header" data-sync-text-default="Nouveau"  />
      </div>

      {{ editEventMacros.countdownForm(editEventPreset, { countdownOffset: countdownOffset }) }}

      <div class="alert alert-info">
        <b>Décalage du début</b>: Au lieu d'une date réelle pour la date limite, définissez un décalage en jours, heures et minutes à partir du début de l'événement. Ce délai sera ajouté à la date de début de l'événement. Les nombres négatifs sont supportés.
      </div>
      {{ editEventMacros.stateForm(editEventPreset) }}
      
      <div class="form-group">
        <button name="save" type="submit" class="btn btn-primary">Sauvegarder</button>
        <a href="?" class="btn btn-default">Annuler</a>
        {% if editEventPreset.get('id') %}
          <div class="pull-right">
            <input type="hidden" name="id" value="{{ editEventPreset.get('id') }}" />
            <button type="submit" class="btn btn-danger" name="delete" onclick="return confirm('Supprimer ce préréglage?')">Supprimer</button>
          </div>
        {% endif %}
      </div>
    </form>
  </div>
{% endif %}

<table class="table">
<thead>
<tr>
  <th>Titre</th>
  <th>Actions</th>
</tr>
</thead>
<tbody>
{% for eventPreset in eventPresets %}
<tr>
  <td>{{ eventPreset.get('title') }}</td>
  <td>
    <a href="?edit={{ eventPreset.get('id') }}" class="btn btn-primary">Modifier</a>
    <a href="?create&reference={{ eventPreset.get('id') }}" class="btn btn-default">Copier</a>
  </td>
</tr>
{% endfor %}
</tbody>
</table>

{% endblock %}